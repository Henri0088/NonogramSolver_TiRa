<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>c:\users\saskeli\documents\visual studio 2015\projects\nonogramsolver\gamelib\nonogram.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Linq;
using System.Text;

namespace GameLib
{
    /// &lt;summary&gt;
    /// Class depicting a nonogram game.
    /// &lt;/summary&gt;
    public class Nonogram
    {
        private readonly Tile[][] _tiles;
        private readonly int[][] _columnNumbers;
        private readonly int[][] _rowNumbers;
        /// &lt;summary&gt;
        /// Number of rows in the nonogram.
        /// &lt;/summary&gt;
        public int Height { get; }
        /// &lt;summary&gt;
        /// Number of columns in the nonogram.
        /// &lt;/summary&gt;
        public int Width { get; }
        /// &lt;summary&gt;
        /// Number of tiles left to resolve.
        /// &lt;/summary&gt;
        public int LeftToClear { get; private set; }

        /// &lt;summary&gt;
        /// Nonogram class constructor
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;columns&quot;&gt;Column clues&lt;/param&gt;
        /// &lt;param name=&quot;rows&quot;&gt;Row clues&lt;/param&gt;
        public Nonogram(int[][] columns, int[][] rows)
        {
            Width = columns.Length;
            Height = rows.Length;
            LeftToClear = Height * Width;
            _tiles = new Tile[Height][];
            int prio;
            for (int i = 0; i &lt; Height; i++)
            {
                _tiles[i] = new Tile[Width];
                for (int j = 0; j &lt; Width; j++)
                {
                    prio = 0;
                    if (i == 0 || i == Height - 1) prio++;
                    if (j == 0 || j == Width - 1) prio++;
                    _tiles[i][j] = new Tile(prio);
                }
            }
            _columnNumbers = columns;
            _rowNumbers = rows;
        }

        /// &lt;summary&gt;
        /// Generates an ugly string representation of the nonogrma
        /// &lt;/summary&gt;
        /// &lt;returns&gt;AN ugly string&lt;/returns&gt;
        public override string ToString()
        {
            StringBuilder sb = new StringBuilder();
            for (int i = 0; i &lt; Height; i++)
            {
                sb.Append(RowString(i));
                sb.Append(&quot;| &quot;);
                sb.AppendLine(RowsNumString(i));
            }
            sb.AppendLine(&quot;Columndata:&quot;);
            for (int i = 0; i &lt; Width; i++)
            {
                sb.Append(&quot;c&quot; + i + &quot;: &quot;);
                sb.AppendLine(ColumnNumString(i));
            }

            return sb.ToString();
        }

        /// &lt;summary&gt;
        /// Generates a string representation of a column clue
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;i&quot;&gt;Column index&lt;/param&gt;
        /// &lt;returns&gt;Ugly string&lt;/returns&gt;
        private string ColumnNumString(int i)
        {
            return String.Join(&quot;, &quot;, _columnNumbers[i].Select(n =&gt; n.ToString()));
        }

        /// &lt;summary&gt;
        /// Generates a string representation of a row clue
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;i&quot;&gt;Row index&lt;/param&gt;
        /// &lt;returns&gt;Ugly string&lt;/returns&gt;
        private string RowsNumString(int i)
        {
            return String.Join(&quot;, &quot;, _rowNumbers[i].Select(n =&gt; n.ToString()));
        }

        /// &lt;summary&gt;
        /// Generates a string reperesentation of the state of a row of the nonogram
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;i&quot;&gt;Row index&lt;/param&gt;
        /// &lt;returns&gt;Ugly string&lt;/returns&gt;
        public string RowString(int i)
        {
            return String.Join(&quot;&quot;, _tiles[i].Select(t =&gt; t.ToChar()));
        }

        /// &lt;summary&gt;
        /// Checks wether a specified tile has been given a value.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;row&quot;&gt;Row index&lt;/param&gt;
        /// &lt;param name=&quot;column&quot;&gt;Column index&lt;/param&gt;
        /// &lt;returns&gt;boolean true for &quot;has a value&quot;, false for no value.&lt;/returns&gt;
        public bool Resolved(int row, int column)
        {
            return _tiles[row][column].State.HasValue;
        }

        /// &lt;summary&gt;
        /// Sets the value of a specified tile
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;row&quot;&gt;Row index&lt;/param&gt;
        /// &lt;param name=&quot;column&quot;&gt;Column index&lt;/param&gt;
        /// &lt;param name=&quot;val&quot;&gt;Value to set&lt;/param&gt;
        public void Set(int row, int column, bool val)
        {
            if (!Resolved(row, column)) LeftToClear--;
            _tiles[row][column].State = val;
        }

        /// &lt;summary&gt;
        /// Removes the value from the specified tile
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;row&quot;&gt;Row index&lt;/param&gt;
        /// &lt;param name=&quot;column&quot;&gt;Column index&lt;/param&gt;
        public void Clear(int row, int column)
        {
            if (Resolved(row, column))
            {
                LeftToClear++;
                _tiles[row][column].State = null;
            }
        }

        /// &lt;summary&gt;
        /// Checks if the specified tile has been set to true
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;row&quot;&gt;Row index&lt;/param&gt;
        /// &lt;param name=&quot;column&quot;&gt;Column index&lt;/param&gt;
        /// &lt;returns&gt;True if tile is set to true, false if tile is not set or set to false.&lt;/returns&gt;
        public bool IsTrue(int row, int column)
        {
            return _tiles[row][column].State.HasValue &amp;&amp; _tiles[row][column].State.Value;
        }

        /// &lt;summary&gt;
        /// Gets one clue number for one row.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;row&quot;&gt;Row index&lt;/param&gt;
        /// &lt;param name=&quot;idx&quot;&gt;Clue index on row&lt;/param&gt;
        /// &lt;returns&gt;Specified clue int&lt;/returns&gt;
        public int GetRowNum(int row, int idx)
        {
            return idx &lt; _rowNumbers[row].Length ? _rowNumbers[row][idx] : 0;
        }

        /// &lt;summary&gt;
        /// Gets on eclue number for one column
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;column&quot;&gt;Column index&lt;/param&gt;
        /// &lt;param name=&quot;idx&quot;&gt;Clue index on column&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public int GetColumnNum(int column, int idx)
        {
            return idx &lt; _columnNumbers[column].Length ? _columnNumbers[column][idx] : 0;
        }

        /// &lt;summary&gt;
        /// Gets total of clues for a given row
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;row&quot;&gt;Row index&lt;/param&gt;
        /// &lt;returns&gt;Sum of clues for given row&lt;/returns&gt;
        public int RowSum(int row)
        {
            return _rowNumbers[row].Sum();
        }

        /// &lt;summary&gt;
        /// Gets total of clues for given column
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;column&quot;&gt;Column index&lt;/param&gt;
        /// &lt;returns&gt;Sum of clues for given column&lt;/returns&gt;
        public int ColumnSum(int column)
        {
            return _columnNumbers[column].Sum();
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[60,9,60,10,0],[61,13,61,52,0],[62,18,62,27,0],[63,13,63,14,0],[64,17,64,41,0],[65,17,65,33,0],[66,17,66,49,0],[67,13,67,14,0],[62,41,62,44,0],[62,29,62,39,0],[68,13,68,42,0],[69,18,69,27,0],[70,13,70,14,0],[71,17,71,43,0],[72,17,72,51,0],[73,13,73,14,0],[69,40,69,43,0],[69,29,69,38,0],[75,13,75,34,0],[76,9,76,10,0],[84,9,84,10,0],[85,13,85,68,0],[85,80,85,83,0],[86,9,86,10,0],[94,9,94,10,0],[95,13,95,65,0],[95,77,95,80,0],[96,9,96,10,0],[104,9,104,10,0],[105,13,105,58,0],[105,68,105,71,0],[106,9,106,10,0],[85,68,85,80,0],[95,65,95,77,0],[105,58,105,68,0],[18,29,18,33,1],[22,28,22,32,1],[26,34,26,38,1],[26,39,26,51,1],[33,9,33,55,1],[34,9,34,10,1],[35,13,35,36,1],[36,13,36,34,1],[37,13,37,42,1],[38,13,38,41,1],[40,18,40,27,1],[41,13,41,14,1],[42,17,42,45,1],[43,22,43,31,1],[44,17,44,18,1],[45,21,45,30,1],[46,21,46,51,1],[46,52,46,59,1],[47,21,47,50,1],[47,51,47,58,1],[48,21,48,51,1],[49,17,49,18,1],[43,44,43,47,1],[43,33,43,42,1],[50,13,50,14,1],[40,41,40,44,1],[40,29,40,39,1],[51,13,51,38,1],[52,13,52,32,1],[53,9,53,10,1],[115,9,115,10,1],[116,13,116,55,1],[117,9,117,10,1],[126,9,126,10,1],[127,13,127,40,1],[127,41,127,55,1],[128,13,128,45,1],[129,9,129,10,1],[137,9,137,10,1],[138,13,138,39,1],[139,13,139,14,1],[140,17,140,31,1],[141,17,141,50,1],[142,13,142,14,1],[143,9,143,10,1],[152,9,152,10,1],[153,13,153,90,1],[154,9,154,10,1],[163,9,163,10,1],[164,13,164,78,1],[165,9,165,10,1],[174,9,174,10,1],[175,13,175,90,1],[176,9,176,10,1],[184,9,184,10,1],[185,13,185,43,1],[186,9,186,10,1],[194,9,194,10,1],[195,13,195,49,1],[196,9,196,10,1]]);
    </script>
  </body>
</html>